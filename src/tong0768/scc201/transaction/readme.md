## 事务

### 四个特性

#### 原子性（Atomicity）Week9.p37

指的是事务被视为不可分割的单元，要么全部执行成功，要么全部不执行。  
在并发环境中，这有助于确保事务的完整性，即使其他事务失败或系统崩溃，也不会影响该事务的完整性。

#### 一致性（Consistency）

要求事务将数据库从一个一致的状态转移到另一个一致的状态。  
在并发环境中，这有助于确保多个事务不会破坏数据库的完整性或产生冲突的数据。

#### 隔离性（Isolation）

确保多个事务可以并发执行，但彼此之间是隔离的，一个事务的操作不应影响其他事务的操作。  
这有助于防止并发执行导致的数据不一致问题，如脏读、不可重复读和幻读。

#### 持久性（Durability）

指的是一旦事务完成提交，其所做的更改将永久保存在数据库中，即使在系统崩溃的情况下也不会丢失。  
在并发环境中，这有助于确保数据的持久性和可靠性，即使系统发生故障，已提交的事务的更改也不会丢失。

#### 例子

考虑一个银行转账的场景，从A账户转账100元到B账户。这个过程包括两个步骤：从A账户减去100元，然后在B账户增加100元。

* **原子性**：两个步骤要么都完成，要么都不完成（回滚）
* **一致性**：一致性要求确保转账前后，A账户和B账户的总金额保持不变。如果在转账过程中违反了这一约束（例如，因为某个错误导致B账户金额增加了200元），那么事务应该被回滚，以保持数据的一致性。
* **隔离性**：如果同时对A账户有其他存取款操作，两个操作不会互相干扰，一个操作失败不会影响另一个操作
* **持久性**：在上述的银行转账场景中，即使银行系统发生了故障或者崩溃，转账的结果（A账户减少100元，B账户增加100元）也应该被永久保存下来。当系统恢复后，这些更改仍然有效，不会被丢失。这就是持久性的体现。

### 事务调度（隔离级别）

#### 串行调度（Serializable）Week9.p42

这是最高的隔离级别。所有事务必须按顺序依次执行，这避免了所有并发问题，但也可能牺牲系统的并发性能。

#### 读未提交（Read Uncommitted）Week9.p46

#### 不可重复读（Unrepeatable Reads）Week9.p47

#### 写被覆盖（Overwriting Uncommitted Data）Week9.p48

### 锁

