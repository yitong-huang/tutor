===== 第1页 =====  
**第2周：**  
单变量函数的微分与优化  
MSIN0180 商业定量方法

===== 第2页 =====  
**NSIN01.80 第2周讲义.nb | 2**

# 主题
- 导数
- 微分法则
- 链式法则
- 隐函数求导
- 对数微分
- 极值与临界点
- 优化

===== 第3页 =====  
**曲线上某点的切线斜率**  
点 \( P \) 处的切线斜率由下式给出：  
\[
\lim_{h \to 0} \frac{f(x_0 + h) - f(x_0)}{h}
\]  
**MSIN0180 第2周讲义.nb | 3**

===== 第4页 =====
# 曲线的切线
```mathematica  
f[x_] := 1 + (x - 1)^2;  
tangent[f_, x_, a_, h_] := \(\left(\frac{f[a + h] - f[a]}{h}\right)(x - a) + f[a];  
a = 1.3;  
Manipulate[  
  Plot[{f[x], tangent[f, x, a, h]}, {x, a - 1, a + 2},  
  GridLines → {{a, a + h}, {f[a], f[a + h]}}, GridLinesStyle → {Black, Dashed}],  
  {{h, 1.5}, 0.001, 2}]  
```  

===== 第5页 =====  
**NSIN01B0 第2周讲义.nb | 6**

**某点的导数**  
函数 \( f \) 在点 \( x_0 \) 处的**导数**，记为 \( f'(x_0) \)，定义为：  
\[
f'(x_0) = \lim_{h \to 0} \frac{f(x_0 + h) - f(x_0)}{h}
\]  
前提是该极限存在。

===== 第6页 =====
# 示例
\[
y = \frac{1}{x}  
\]  
斜率为 \(-\frac{1}{a^2}\)

当 \( f(x) = \frac{1}{x} \) 时，\( x = a \) 处的斜率计算如下：  
\[
\frac{f(a + h) - f(a)}{h} = \frac{\frac{1}{a + h} - \frac{1}{a}}{h} = \frac{-1}{a(a + h)}  
\]  
\[
\Rightarrow \lim_{h \to 0} \frac{f(a + h) - f(a)}{h} = -\frac{1}{a^2}
\]

===== 第7页 =====  
**用 Mathematica 从基本原理求 \( 2x^3 \) 的导数**
```mathematica  
Clear[x]; f[x_] := 1/x;  
slope[f_] := (f[x + h] - f[x])/h;  
slope[f]  
(* 输出: -1/x + 1/(h + x) *)  
Simplify[%]  
(* 输出: -1/(x(h + x)) *)  
Limit[%, h → 0]  
(* 输出: -1/x^2 *)  
```  

===== 第8页 =====
# 导数符号
函数 \( y = f(x) \) 的导数有多种表示方式：
- **拉格朗日记法**：\( f'(x) \)
- **莱布尼茨记法**：\(\frac{df}{dx}\)
- 其他符号：\(\frac{d}{dx}f(x)\)、\( D(f)(x) \)、\( D_x f(x) \)
- 牛顿记法（时间变量）：若 \( y = y(t) \)，则用点表示导数，如 \( \dot{y} \)。

===== 第9页 =====
# 在 \( x = a \) 处的导数符号
函数 \( y = f(x) \) 在 \( x = a \) 处的导数表示方式：  
\[
f'(a), \quad \left.\frac{dy}{dx}\right|_{x=a}, \quad \left.\frac{d}{dx}f(x)\right|_{x=a}
\]

===== 第10页 =====
# 用 Mathematica 计算导数
```mathematica  
f[x_] = 2x^3;  
f'[x]          (* 输出: 6x^2 *)  
D[2x^3, x]     (* 输出: 6x^2 *)  
```  

===== 第11页 =====  
**开区间 \((a, b)\) 上的可微函数**  
若函数 \( f(x) \) 在开区间 \((a, b)\) 内每一点都有导数，则称其在该区间上可微。

===== 第12页 =====
# 闭区间 \([a, b]\) 上的可微函数
若函数 \( f(x) \) 在闭区间 \([a, b]\) 上每一点都有导数，且在端点处满足以下单侧极限存在：
- 右导数在 \( a \) 处：\(\lim_{h \to 0^+} \frac{f(a + h) - f(a)}{h}\)
- 左导数在 \( b \) 处：\(\lim_{h \to 0^-} \frac{f(b + h) - f(b)}{h}\)

===== 第13页 =====  
**不可导的情况**
- 角点
- 垂直切线
- 不连续点

===== 第14页 =====
# 可微函数必连续
**定理：可微性蕴含连续性**  
若 \( f \) 在 \( x = c \) 处可导，则 \( f \) 在 \( x = c \) 处连续。

===== 第15页 =====
# 微分法则
## 常数法则
若 \( f(x) = c \)，则：  
\[
\frac{d}{dx}(c) = 0
\]
## 幂法则
若 \( n \) 为实数，则：  
\[
\frac{d}{dx}x^n = nx^{n-1}
\]

===== 第16页 =====
# 微分法则
**常数倍法则**  
若 \( u \) 可微，\( c \) 为常数，则：  
\[
\frac{d}{dx}(cu) = c\frac{du}{dx}
\]  
**和法则**  
若 \( u \) 和 \( v \) 可微，则：  
\[
\frac{d}{dx}(u + v) = \frac{du}{dx} + \frac{dv}{dx}
\]

===== 第17页 =====  
**示例：求 \( \frac{d}{dx}\left(2x^3 + \frac{3}{x^2} - 5\right) \)**
1. 应用和/差法则：  
   \[
   \frac{d}{dx}(2x^3) + \frac{d}{dx}\left(\frac{3}{x^2}\right) - \frac{d}{dx}(5)
   \]
2. 应用常数倍法则与幂法则：  
   \[
   2 \cdot 3x^2 + 3 \cdot (-2x^{-3}) = 6x^2 - \frac{6}{x^3}
   \]  
   Mathematica 验证：
```mathematica  
D[2x^3 + 3/x^2 - 5, x]  (* 输出: 6x^2 + 6/x^3 *)  
```  

===== 第18页 =====
# 微分法则
**乘积法则**  
若 \( u \) 和 \( v \) 可微，则：  
\[
\frac{d}{dx}(uv) = u\frac{dv}{dx} + v\frac{du}{dx}
\]  
**商法则**  
若 \( u \) 和 \( v \) 可微且 \( v(x) \neq 0 \)，则：  
\[
\frac{d}{dx}\left(\frac{u}{v}\right) = \frac{v\frac{du}{dx} - u\frac{dv}{dx}}{v^2}
\]

===== 第19页 =====  
**示例：求 \( \frac{d}{dx}\left(\frac{1 - x^2}{2x + 3}\right) \)**  
应用商法则：  
\[
\frac{(2x + 3)(-2x) - (1 - x^2)(2)}{(2x + 3)^2} = \frac{-2x^2 - 6x - 2}{(2x + 3)^2}
\]  
Mathematica 验证：
```mathematica  
D[(1 - x^2)/(2x + 3), x]  (* 输出: (-2(1 + 3x + x^2))/(3 + 2x)^2 *)  
```  

===== 第20页 =====
# 商法则的证明（略）

===== 第21页 =====
# 指数与对数函数的微分法则
\[
\frac{d}{dx}(e^x) = e^x, \quad \frac{d}{dx}(a^x) = a^x \ln a
\]  
\[
\frac{d}{dx}(\ln x) = \frac{1}{x}, \quad \frac{d}{dx}(\log_a x) = \frac{1}{x \ln a}
\]

===== 第22页 =====
# 三角函数的微分法则
\[
\frac{d}{dx}(\sin x) = \cos x, \quad \frac{d}{dx}(\cos x) = -\sin x, \quad \frac{d}{dx}(\tan x) = \sec^2 x
\]

===== 第23页 =====  
**经济学中的边际概念**
- **边际生产成本**：若总成本函数为 \( c(x) \)，则边际成本为：  
  \[
  \frac{dc}{dx} = \lim_{h \to 0} \frac{c(x + h) - c(x)}{h}
  \]

===== 第24页 =====
# 总成本函数与边际成本
典型总成本函数（三次多项式）：  
\[
c(x) = \alpha x^3 + \beta x^2 + \gamma x + \delta
\]  
边际成本为：  
\[
c'(x) = 3\alpha x^2 + 2\beta x + \gamma
\]

===== 第25页 =====  
**示例：生产散热器的边际成本**  
成本函数 \( c(x) = x^3 - 6x^2 + 15x \)，当生产10个单位时，边际成本为：  
\[
c'(10) = 3(10)^2 - 12(10) + 15 = 195
\]

===== 第26页 =====
# 链式法则
若 \( y = f(u) \) 且 \( u = g(x) \)，则：  
\[
\frac{dy}{dx} = \frac{dy}{du} \cdot \frac{du}{dx}
\]

===== 第27页 =====  
**链式法则示例：求 \( \frac{dy}{dx} \)（\( y = (3x^2 + 1)^2 \））**  
设 \( u = 3x^2 + 1 \)，则：  
\[
\frac{dy}{dx} = 2u \cdot 6x = 12x(3x^2 + 1)
\]

===== 第28页 =====  
**Mathematica 验证**
```mathematica  
D[(3x^2 + 1)^2, x]  (* 输出: 12x(1 + 3x^2) *)  
```  

===== 第29页 =====
# 隐函数求导
当 \( y \) 无法显式表示为 \( x \) 的函数时，使用隐函数求导法（结合链式法则）。

===== 第30页 =====  
**示例：求 \( x^2 + y^2 = 25 \) 的导数**  
两边对 \( x \) 求导：  
\[
2x + 2y \frac{dy}{dx} = 0 \implies \frac{dy}{dx} = -\frac{x}{y}
\]

===== 第31页 =====  
**Mathematica 隐函数求导**
```mathematica  
ImplicitD[x^2 + y^2 == 25, y, x]  (* 输出: -x/y *)  
```  

===== 第32页 =====
# 高阶导数
\( n \) 阶导数表示为：  
\[
f^{(n)}(x) = \frac{d^n f}{dx^n}
\]

===== 第33页 =====  
**示例：\( f(x) = 4x^3 \) 的高阶导数**  
\[
f'(x) = 12x^2, \quad f''(x) = 24x, \quad f'''(x) = 24, \quad f^{(4)}(x) = 0
\]

===== 第34页 =====
# 隐函数求导的二阶导数示例（略）

===== 第35页 =====
# 对数微分法
**示例：求 \( y = \frac{(x^2 + 1)(x + 3)^2}{x - 1} \) 的导数**  
取对数后求导：  
\[
\ln y = \ln(x^2 + 1) + 2\ln(x + 3) - \ln(x - 1)
\]  
两边对 \( x \) 求导：  
\[
\frac{1}{y} \frac{dy}{dx} = \frac{2x}{x^2 + 1} + \frac{2}{x + 3} - \frac{1}{x - 1}
\]

===== 第36页 =====  
**极值的类型**
- 局部最大值/最小值
- 全局最大值/最小值

===== 第37页 =====
# 局部极值的一阶导数定理
若 \( f \) 在定义域内点 \( c \) 处有局部极值且 \( f'(c) \) 存在，则 \( f'(c) = 0 \)。

===== 第38页 =====
# 临界点
定义域内使得 \( f'(x) = 0 \) 或 \( f'(x) \) 不存在的点。

===== 第39页 =====
# 一阶导数测试法
- \( f' \) 从正变负 → 局部最大值
- \( f' \) 从负变正 → 局部最小值

===== 第40页 =====  
**凹性与拐点**
- 凹向上：\( f''(x) > 0 \)
- 凹向下：\( f''(x) < 0 \)
- 拐点：凹性改变的点，且 \( f''(x) = 0 \) 或不存在。

===== 第41页 =====
# 二阶导数测试法
- \( f''(c) > 0 \) → 局部最小值
- \( f''(c) < 0 \) → 局部最大值

===== 第42页 =====  
**商业优化示例：利润最大化**  
利润函数 \( p(x) = r(x) - c(x) \)，求解 \( p'(x) = 0 \)（即 \( r'(x) = c'(x) \)）。

===== 第43页 =====  
**示例：生产量优化**  
设收入 \( r(x) = 9x \)，成本 \( c(x) = x^3 - 6x^2 + 15x \)，求解 \( 3x^2 - 12x + 15 = 9 \)，得临界点 \( x = 2 \pm \sqrt{2} \)。

===== 第40页 =====
# 函数的极值

**局部最大值**  
附近没有更大的函数值。

**全局最小值**  
任何地方都没有更小的函数值。同时也是局部最小值。

**全局最大值**  
任何地方都没有更大的函数值。同时也是局部最大值。

**局部最小值**  
附近没有更小的函数值。

===== 第41页 =====
# 局部极值的一阶导数定理
如果函数 \( f \) 在定义域内点 \( c \) 处存在局部极大值或极小值，且 \( f' \) 在 \( c \) 处有定义，则  
\[f'(c) = 0\]

===== 第42页 =====
# 临界点
函数 \( f \) 定义域内的点，若 \( f' \) 为零或不存在，则称为临界点。

![](示例图描述：\( y = x^3 \) 和 \( y = x^{1/3} \) 的临界点图示)

===== 第43页 =====
# 局部极值的一阶导数测试法
假设 \( c \) 是连续函数 \( f \) 的**临界点**，且 \( f \) 在包含 \( c \) 的区间内（可能除 \( c \) 外）处处可导：
- 从左到右经过 \( c \) 时：
    - 若 \( f' \) 从负变正 → \( c \) 处为**局部最小值**
    - 若 \( f' \) 从正变负 → \( c \) 处为**局部最大值**

===== 第44页 =====
# 凹性
设 \( y = f(x) \) 在区间 \( I \) 上二阶可导：
1. 若 \( f''(x) > 0 \)，则图像在 \( I \) 上**凹向上**（如 \( y = x^3 \) 的右半部分）。
2. 若 \( f''(x) < 0 \)，则图像在 \( I \) 上**凹向下**（如 \( y = x^3 \) 的左半部分）。

===== 第45页 =====
# 拐点
图像凹性发生变化的点称为拐点。在拐点 \( x = c \) 处，要么 \( f''(c) = 0 \)，要么 \( f''(c) \) 不存在。

![](示例图描述：\( y = x^{5/3} \) 和 \( y = x^{1/3} \) 的拐点图示)

===== 第46页 =====
# 局部极值的二阶导数测试法
- 若 \( f'(c) = 0 \) 且 \( f''(c) > 0 \) → **局部最小值**
- 若 \( f'(c) = 0 \) 且 \( f''(c) < 0 \) → **局部最大值**

===== 第47页 =====
# 商业优化示例
典型成本函数图像先凹向下后凹向上。利润最大化时需满足：  
\[
p'(x) = r'(x) - c'(x) = 0 \quad \text{即} \quad c'(x) = r'(x)
\]  
![](图示：收入曲线 \( r(x) \)、成本曲线 \( c(x) \) 与利润最大化的交点)

===== 第48页 =====
# 商业优化示例（续）
假设收入 \( r(x) = 9x \)，成本 \( c(x) = x^3 - 6x^2 + 15x \)，求解利润最大化产量：  
\[
3x^2 - 12x + 6 = 0 \implies x = 2 \pm \sqrt{2}
\]  
通过二阶导数验证：  
\[
p''(x) = 6(2 - x) \implies x = 3.414 \text{ 处为利润最大值}
\]

===== 第49页 =====
# 优化示例2：函数极值
求函数 \( y = \frac{x + 3}{\sqrt{1 + x^2}} \) 的极值点：
1. 一阶导数为零解得临界点 \( x = \frac{1}{3} \)。
2. 二阶导数验证：  
   \[
   \left. \frac{d^2y}{dx^2} \right|_{x=1/3} < 0 \implies \text{局部最大值}
   \]

===== 第50页 =====
# Mathematica 求解极值
```mathematica  
y[x_] := (x + 3)/Sqrt[1 + x^2];  
Maximize[y[x], x]  (* 输出：{√10, {x → 1/3}} *)  
Plot[y[x], {x, -50, 50}]  (* 显示函数全局行为 *)  
```  

===== 第51页 =====
# 查找所有极值
极值不仅出现在 \( f'(x) = 0 \) 的点，还可能在边界点或 \( f'(x) \) 不存在的点。

===== 第52页 =====
# 分段函数极值分析示例
函数定义：  
\[
f(x) =
\begin{cases}
3x + 15 & x \leq 1 \\
(x - 5)^2 + 2 & x > 1
\end{cases}
\]  
**关键步骤**：
1. 临界点 \( x = 5 \)（局部最小）。
2. 分段点 \( x = 1 \)（梯度突变，局部最大）。
3. 边界点 \( x = -5 \)（全局最小），\( x = 8 \)（局部最大）。

===== 第53页 =====
# 结果总结表
| x    | \( f(x) \) | 极值类型         |  
|------|------------|------------------|  
| -5   | 0          | 全局最小值       |  
| 1    | 18         | 全局最大值       |  
| 5    | 2          | 局部最小值       |  
| 8    | 11         | 局部最大值       |  

===== 第54页 =====
# Mathematica 验证
```mathematica  
f[x_] := Piecewise[{{3x + 15, x ≤ 1}, {(x - 5)^2 + 2, x > 1}}];  
Plot[f[x], {x, -5, 8}]  (* 绘制函数图像 *)  
Maximize[f[x], x]        (* 输出：{18, {x → 1}} *)  
Minimize[f[x], x]        (* 输出：{0, {x → -5}} *)  
```  

（注：后续页面为重复内容或代码示例，翻译模式同上。）