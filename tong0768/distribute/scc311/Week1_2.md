#### 第3页
**概述**
- **远程调用**：通过特定协议在另一台计算机上执行逻辑的过程。
- 消息交换通过协议处理，不同协议提供不同的可靠性、可扩展性和性能。
- 协议实现及相关工具称为**通信中间件**。

---

#### 第4页
**协议风格**  
| 类型 | 客户端发送 | 服务器发送 | 客户端确认 |  
|------|------------|------------|------------|  
| R    | 请求       | -          | -          | （无返回，非阻塞）  
| RR   | 请求       | 响应       | -          | （若响应丢失，客户端可能重试）  
| RRA  | 请求       | 响应       | 确认       | （服务器需确保客户端收到响应）

---

#### 第5-6页
**基本远程调用（客户端与服务器示例）**
- **客户端**：通过TCP连接发送消息头（`Header`）和传感器数据（`SensorInfo`）。
- **服务器**：绑定端口，接收消息，解析类型并保存数据。
- 关键步骤：
    - 客户端与服务器需**预先约定消息格式**（如`Header`和`SensorInfo`结构）。
    - 使用TCP协议确保可靠传输。

---

#### 第7-8页
**RPC（远程过程调用）**
- **核心思想**：客户端调用远程函数如同本地调用，中间件隐藏底层通信细节。
- **同步特性**：客户端阻塞等待结果。
- **协议语义**：
    - **至少一次**（重试请求，可能导致重复执行）。
    - **至多一次**（过滤重复请求，避免重复执行）。
    - **恰好一次**（原子性保证，需结合容错机制）。

---

#### 第9-16页
**RPC中间件与接口设计**
- **关键组件**：
    - **客户端存根（Client Stub）**：序列化请求并发送。
    - **服务器存根（Server Stub）**：反序列化请求并调用实际方法。
    - **调度器（Dispatcher）**：将请求路由到正确的存根。
- **接口定义语言（IDL）**：跨语言定义接口参数和类型，实现接口与实现的分离。

---

#### 第17-18页
**RMI（Java远程方法调用）**
- **特点**：
    - Java原生实现，透明远程对象调用。
    - 通过`RemoteException`暴露远程调用异常。
- **RMI注册表（Registry）**：管理远程对象名称与引用（如`rmiregistry`服务）。

---

#### 第19-22页
**RPC的潜在问题**
- **网络延迟**：远程调用比本地调用慢。
- **内存模型差异**：传递对象引用可能导致分布式内存问题。
- **部分故障**：客户端或服务器崩溃可能导致不一致状态。

---

#### 第23-27页
**REST架构**
- **核心原则**：
    - 资源通过URI标识（如`GET /students/1234`）。
    - 使用HTTP方法（GET/POST/PUT/DELETE）操作资源。
    - **无状态**：请求包含所有必要信息（如Cookie）。
- **HTTP状态码**：
    - 2xx（成功）、4xx（客户端错误）、5xx（服务器错误）。
- **与RPC对比**：
    - RPC关注操作（如`readStudent(1234)`），REST关注资源（如`GET /students/1234`）。

---

### 知识点总结与解释

1. **远程调用基础**
    - **协议风格**：
        - **R（Fire-and-Forget）**：适用于无需确认的场景（如日志上报）。
        - **RR（Request-Reply）**：典型请求-响应模式，需处理重试（如HTTP）。
        - **RRA（Request-Reply-Acknowledge）**：确保客户端确认（如资源释放）。

2. **RPC与中间件**
    - **RPC核心**：隐藏网络细节，使远程调用像本地函数调用。
    - **存根与调度器**：客户端存根负责序列化，服务器存根负责反序列化，调度器路由请求。
    - **协议语义**：
        - **至少一次**：适用于幂等操作（如查询）。
        - **至多一次**：通过唯一ID过滤重复请求（如支付）。

3. **Java RMI**
    - **透明性**：通过接口实现远程对象调用，但需处理`RemoteException`。
    - **注册表**：通过`rmiregistry`管理远程对象名称与引用。

4. **REST架构**
    - **资源导向**：URI标识资源，HTTP方法定义操作。
    - **无状态性**：每个请求包含完整上下文，适合横向扩展。
    - **HTTP语义**：状态码和动词标准化交互（如`GET`幂等，`POST`非幂等）。

5. **对比与适用场景**
    - **RPC/RMI**：适合紧密耦合的系统（如Java应用集群）。
    - **REST**：适合松耦合、跨平台的Web服务（如公开API）。

---

### 关键术语对照
- **Stub** → 存根
- **Middleware** → 中间件
- **Idempotent** → 幂等
- **Dispatcher** → 调度器
- **Marshalling/Unmarshalling** → 序列化/反序列化

通过理解这些概念，可以更好地设计分布式系统，选择适合的通信协议和中间件技术。